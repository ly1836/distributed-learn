
stages:
  - pull
  - build
  - deploy

pull:
  stage: pull
  script:
    - sudo git pull .
  tags:
    - kubernetes
  only:
    - master


build:
  stage: build
  script:
    - mvn clean package docker:build -Dmaven.test.skip=true
    - sudo ls -l
  tags:
    - kubernetes
  only:
    - master

deploy:
  stage: deploy
  script:
    - cd kubernetes
    - kubectl apply -f deployment.yaml
    - kubectl get pod,svc,deploy
  tags:
    - kubernetes
  only:
    - master